{% extends 'main.html' %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/cart.css' %}">
{% endblock %}
{% block content %}

<div class="order-container">
  <h2>Your Order History</h2>
  {% if orders %}
    {% for order in orders %}
    <div class="order-card">
      <div class="order-header">
        <div>
          <strong>Order ID:</strong> #{{ order.order_id|stringformat:".8s" }}...<br>
          <small>Placed on: {{ order.created|date:"d M Y" }}</small>
        </div>
        <div class="text-right">
          <span class="status-badge status-{{ order.status|lower }}">{{ order.status }}</span><br>
          <strong style="font-size: 1.2rem;">Total: ₹{{ order.total }}</strong>
        </div>
      </div>

      <!-- Loop through items for THIS specific order -->
      {% for item in order.orderitem_set.all %}
      <div class="order-item">
        <div class="item-image">
          <img src="{% static item.flower.img %}" alt="{{ item.flower.flowername }}">
        </div>
        <div class="item-details">
          <h5>{{ item.flower.flowername }}</h5>
          <p>Qty: {{ item.quantity }} × ₹{{ item.price }}</p>
        </div>
        <div class="item-total">
          ₹{{ item.price }}
        </div>
      </div>
      {% endfor %}
    </div>
    {% endfor %}
  {% else %}
    <p>You haven't placed any orders yet.</p>
  {% endif %}
</div>
{% endblock %}
